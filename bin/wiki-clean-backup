#!/bin/bash
#
# Run with -d to bypass confirmation

ARG=$1
NBCKPS=$2

# Check if -b was passed; if not, prompt user for confirmation
if [ $# -gt 0 ] ; then
    if [ $1 = "-d" ] ; then
        echo "Confirmation bypassed."
    else
        echo "Invalid option."
        exit
    fi
else
    read -p "Are you sure you want to remove $NBCKPS old backups? (yes/[no]) "
    if [ ! -z $REPLY ] && [ $REPLY = "yes" ] ; then
        echo "Removing confirmed."
    else
        echo "Removing aborted."
        exit
    fi
fi

if [ -z "$ARG" ] || [ -z "$NBCKPS" ] ; then
    return
fi

cd /home/backup/$ARG
NFILES=$(ls -1 | wc -l)

if [ $NFILES -gt $NBCKPS ] ; then
    rm $(ls -1 | head -n 1)
fi
