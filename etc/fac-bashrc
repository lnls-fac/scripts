# Paths
# =====
#
# First, look for a file named .fac_root_path in user home directory. If file
# exists, source it; if FACROOT is not defined after sourcing, use the 
# default value (Linux).
#
# If that file does not exist, check whether there is a /home directory. In
# case it is found, use default value for FACROOT.
#
# Finally, check whether a /Users directory exists. If it is found, use
# /Users/fac_files as FACROOT (Mac OS X).
#
# If none of the above is true, print a message, and FACROOT is left
# undefined.
FACROOTPATH=~/.fac_root_path
FACROOTDEFAULT=/home/fac_files

if [ -f $FACROOTPATH ] ; then
    source $FACROOTPATH
    if [ -z $FACROOT ] ; then
        export FACROOT=$FACROOTDEFAULT
    fi
elif [ -d /home ] ; then
    export FACROOT=$FACROOTDEFAULT
elif [ -d /Users ] ; then
    export FACROOT=/Users/fac_files
else
    echo "FACROOT not defined!"
fi

export FACCODE=$FACROOT/code
export FACDATA=$FACROOT/data

# Python
# ======
export PYTHONPATH=$PYTHONPATH:$FACCODE/job_manager/src

# FAC scripts
# ===========
export PATH=$PATH:$FACCODE/job_manager/apps
export PATH=$PATH:$FACCODE/scripts/fieldmap_analysis

# EPICS
# =====
export EPICS_BASE=/usr/local/epics/R3.14/base
export EPICS_HOST_ARCH=linux-x86_64
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$EPICS_BASE/lib/$EPICS_HOST_ARCH
export EV4_BASE=/usr/local/epics/v4
export PVDATABASE=$EV4_BASE/pvDatabaseCPP
export PVASRV=$EV4_BASE/pvaSrv
export PVACCESS=$EV4_BASE/pvAccessCPP
export NORMATIVETYPES=$EV4_BASE/normativeTypesCPP
export PVDATA=$EV4_BASE/pvDataCPP
export PVCOMMON=$EV4_BASE/pvCommonCPP
export PATH=$PATH:$EPICS_BASE/bin/$EPICS_HOST_ARCH
export PATH=$PATH:$PVACCESS/bin/$EPICS_HOST_ARCH

# Definitions for elegant rpn
# ===========================
export RPN_DEFNS=/usr/local/epics_oag/defns.rpn

# Elegant and related software (including geneticOptimizer)
# =========================================================
export HOST_ARCH=linux-x86_64
export OAG_TOP_DIR=/usr/local/epics_oag

# Elegant and OAG configs
# =======================
export PATH=$PATH:/usr/local/epics_oag/epics/base/bin/linux-x86_64:/usr/local/epics_oag/epics/extensions/bin/linux-x86_64:/usr/local/epics_oag/oag/apps/bin/linux-x86_64
export TCLLIBPATH="/usr/local/epics_oag/oag/apps/lib/linux-x86_64 /usr/local/epics_oag/epics/extensions/lib/linux-x86_64 /usr/local/epics_oag/oag/apps/lib/linux-x86_64/sdds /usr/local/epics_oag/oag/apps/lib/linux-x86_64/os /usr/local/epics_oag/oag/apps/lib/linux-x86_64/ca /usr/local/epics_oag/oag/apps/lib/linux-x86_64/rpn"
export PYTHONPATH=$PYTHONPATH:/usr/local/epics_oag/oag/apps/lib/linux-x86_64:/usr/local/epics_oag/epics/extensions/lib/linux-x86_64

# Completion for JobManager functions
# ===================================
complete -W "--description --exec --inputFiles --workingDirectory --priority --possibleHosts --help"                                    pyjob_qsub.py
complete -W "--clients --showCalendar --help"                                                                                           pyjob_configs_get.py
complete -W "--clients --niceness --shutdown --remove --MoreJobs --defnumproc --calendar --weekday --initial --final --num_proc --help" pyjob_configs_set.py
complete -W "--sure --help"                                                                                                             pyjob_shutdown.py
complete -W "--jobs --status --user --description --explicate --choose --help"                                                          pyjob_qstat.py
complete -W "--jobs --status --user --description --signal --priority --possibleHosts --help"                                           pyjob_qsig.py
complete -W "help clean edit run summary rawfield trajectory multipoles model summary"                                                  fma-analysis.py
complete -W "--input-file"                                                                                                              fma-rawfield.py

# Completion for VA
# =================
complete -W "stop start list vaca si_current si_lifetime si_bpms si_ps si_tune topup"  sirius-va

# Aliases
# =======
alias gocode='cd $FACCODE'
alias godata='cd $FACDATA'
alias golnls='cd $FACCODE/lnls'
alias gosirius='cd $FACCODE/sirius'
alias gotrackcpp='cd $FACCODE/trackcpp'
alias gomathphys='cd $FACCODE/mathphys'
alias gova='cd $FACCODE/va'
alias goscripts='cd $FACCODE/scripts'
alias gofieldmap='cd $FACDATA/sirius/si/magnet_modelling'
alias gopyaccel='cd $FACCODE/pyaccel'
alias gocalcs='cd $FACDATA/sirius/si/beam_dynamics/calcs/v07/c05'
alias gooficial='cd $FACDAT/sirius/si/beam_dynamics/oficial/v07/c05'
